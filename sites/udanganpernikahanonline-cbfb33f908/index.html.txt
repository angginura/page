<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Wedding of Stevin & Sittri</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Plus+Jakarta+Sans:wght@300;400;600&family=Great+Vibes&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-dark: #194E5D;
            --primary-light: #2C7B8B;
            --accent: #E2BFA1;
            --bg-light: #F0EDE7;
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--bg-light);
            color: var(--primary-dark);
            overflow-x: hidden;
            margin: 0;
        }

        body.no-scroll { overflow: hidden; }

        h1, h2, h3, .font-serif { font-family: 'Playfair Display', serif; }
        .font-cursive { font-family: 'Great Vibes', cursive; }

        /* Animasi Muncul */
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 1.2s cubic-bezier(0.22, 1, 0.36, 1);
        }

        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }

        /* Sampul Mewah */
        #cover-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--primary-dark);
            z-index: 10000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: transform 1.8s cubic-bezier(0.85, 0, 0.15, 1);
            color: white;
            text-align: center;
        }

        #cover-overlay.fade-out { transform: translateY(-100%); }

        /* Navigasi Melayang */
        #floating-nav {
            position: fixed;
            bottom: 25px;
            left: 50%;
            transform: translateX(-50%) translateY(120px);
            background: rgba(25, 78, 93, 0.95);
            backdrop-filter: blur(12px);
            padding: 14px 28px;
            border-radius: 100px;
            z-index: 5000;
            display: flex;
            gap: 20px;
            border: 1px solid var(--accent);
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        #floating-nav.show { transform: translateX(-50%) translateY(0); }
        .nav-link { color: white; font-size: 9px; text-transform: uppercase; letter-spacing: 2px; font-weight: 600; opacity: 0.7; transition: 0.3s; }
        .nav-link:hover { opacity: 1; color: var(--accent); }

        /* Kartu & Tombol */
        .glass-card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(226, 191, 161, 0.4);
            border-radius: 50px 50px 0 50px;
        }

        .btn-luxury {
            background: var(--accent);
            color: var(--primary-dark);
            padding: 16px 45px;
            border-radius: 100px;
            font-weight: 600;
            letter-spacing: 2px;
            transition: all 0.4s ease;
            box-shadow: 0 10px 30px rgba(226, 191, 161, 0.3);
            border: none;
            cursor: pointer;
            text-transform: uppercase;
            font-size: 11px;
        }
        .btn-luxury:hover:not(:disabled) { transform: translateY(-3px); background: white; }
        .btn-luxury:disabled { opacity: 0.6; cursor: not-allowed; }

        .music-control {
            position: fixed;
            top: 30px;
            right: 30px;
            z-index: 6000;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: var(--primary-dark);
            color: var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 1px solid var(--accent);
        }
        .playing svg { animation: spin 8s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* TATA LETAK GALERI EDITORIAL (BENTO GRID) */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-auto-rows: 200px;
            gap: 12px;
        }
        @media (min-width: 768px) {
            .gallery-grid {
                grid-template-columns: repeat(4, 1fr);
                grid-auto-rows: 250px;
                gap: 20px;
            }
            .gallery-item.large { grid-column: span 2; grid-row: span 2; }
            .gallery-item.tall { grid-row: span 2; }
            .gallery-item.wide { grid-column: span 2; }
        }
        .gallery-item {
            position: relative;
            overflow: hidden;
            border-radius: 1.5rem;
            border: 1px solid rgba(226, 191, 161, 0.3);
            background-color: #eee;
        }
        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 1.5s cubic-bezier(0.19, 1, 0.22, 1);
        }
        .gallery-item:hover img { transform: scale(1.1); }

        /* Timeline Story */
        .story-line {
            position: relative;
            max-width: 800px;
            margin: 0 auto;
        }
        .story-line::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 1px;
            background: linear-gradient(to bottom, transparent, var(--accent), transparent);
            transform: translateX(-50%);
        }
        .timeline-dot {
            width: 12px;
            height: 12px;
            background: var(--accent);
            border-radius: 50%;
            margin: 20px auto;
            position: relative;
            z-index: 2;
            box-shadow: 0 0 0 8px rgba(226, 191, 161, 0.2);
        }

        /* Toast Notification */
        #toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--primary-dark);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            z-index: 9999;
            transition: transform 0.5s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        #toast.show { transform: translateX(-50%) translateY(0); }
    </style>
</head>
<body class="no-scroll">

    <!-- Layer Sampul -->
    <div id="cover-overlay">
        <div class="reveal active">
            <p class="text-[10px] tracking-[0.6em] uppercase mb-6 opacity-80 text-[#E2BFA1]">The Wedding of</p>
            <h1 class="text-7xl md:text-9xl font-cursive mb-10 text-[#F0EDE7]">Stevin & Sittri</h1>
            <div class="mb-14 px-6">
                <p class="text-xs opacity-50 mb-3 font-light tracking-widest uppercase">KEPADA BAPAK/IBU/SAUDARA/I:</p>
                <h3 id="guest-name" class="text-2xl font-serif italic tracking-wide text-white">Tamu Undangan Spesial</h3>
            </div>
            <button onclick="openInvitation()" class="btn-luxury">BUKA UNDANGAN</button>
        </div>
    </div>

    <!-- Kontrol Musik -->
    <div id="musicToggle" class="music-control hidden" onclick="toggleMusic()">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 256 256">
            <path d="M210.3,56.34l-80-48A8,8,0,0,0,118,15.09V134.11a44,44,0,1,0,16,33.89V31l66.3,39.78a8,8,0,0,0,8.23-13.72ZM88,200a28,28,0,1,1,28-28A28,28,0,0,1,88,200Z"></path>
        </svg>
    </div>

    <!-- Navigasi Melayang -->
    <nav id="floating-nav">
        <a href="#home" class="nav-link">Home</a>
        <a href="#couple" class="nav-link">Couple</a>
        <a href="#story" class="nav-link">Story</a>
        <a href="#event" class="nav-link">Event</a>
        <a href="#gallery" class="nav-link">Gallery</a>
        <a href="#rsvp" class="nav-link">RSVP</a>
    </nav>

    <!-- Audio -->
    <audio id="weddingMusic" loop>
        <source src="Yovie & Nuno - Janji Suci (Video Clip).mp3" type="audio/mpeg">
    </audio>

    <!-- Notifikasi -->
    <div id="toast">Nomor rekening berhasil disalin!</div>

    <main id="home">
        <!-- Hero Section -->
        <section class="relative h-screen flex items-center justify-center overflow-hidden">
            <div class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1519225421980-715cb0215aed?auto=format&fit=crop&q=80')] bg-cover bg-fixed bg-center"></div>
            <div class="absolute inset-0" style="background: linear-gradient(to bottom, rgba(25, 78, 93, 0.85), rgba(240, 237, 231, 1));"></div>
            <div class="relative z-10 text-center px-6">
                <div class="reveal">
                    <p class="text-xs tracking-[0.8em] text-white uppercase mb-8">Sabtu, 13 Juni 2026</p>
                    <h2 class="text-7xl md:text-[10rem] text-white font-cursive leading-none mb-12">Stevin & Sittri</h2>
                    
                    <div class="grid grid-cols-4 gap-4 max-w-lg mx-auto mb-16">
                        <div class="bg-white/10 backdrop-blur-md rounded-2xl p-4 border border-white/20">
                            <span id="days" class="block text-2xl md:text-3xl font-bold text-white">00</span>
                            <span class="text-[8px] uppercase tracking-widest text-[#E2BFA1]">Hari</span>
                        </div>
                        <div class="bg-white/10 backdrop-blur-md rounded-2xl p-4 border border-white/20">
                            <span id="hours" class="block text-2xl md:text-3xl font-bold text-white">00</span>
                            <span class="text-[8px] uppercase tracking-widest text-[#E2BFA1]">Jam</span>
                        </div>
                        <div class="bg-white/10 backdrop-blur-md rounded-2xl p-4 border border-white/20">
                            <span id="minutes" class="block text-2xl md:text-3xl font-bold text-white">00</span>
                            <span class="text-[8px] uppercase tracking-widest text-[#E2BFA1]">Menit</span>
                        </div>
                        <div class="bg-white/10 backdrop-blur-md rounded-2xl p-4 border border-white/20">
                            <span id="seconds" class="block text-2xl md:text-3xl font-bold text-white">00</span>
                            <span class="text-[8px] uppercase tracking-widest text-[#E2BFA1]">Detik</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Mempelai -->
        <section id="couple" class="py-32 px-6 bg-white">
            <div class="max-w-6xl mx-auto">
                <div class="text-center mb-24 reveal">
                    <h2 class="text-4xl font-serif italic mb-4">Mempelai Berbahagia</h2>
                    <div class="w-24 h-[1px] bg-[var(--accent)] mx-auto"></div>
                </div>

                <div class="grid md:grid-cols-2 gap-24 items-center">
                    <!-- Groom -->
                    <div class="reveal flex flex-col items-center md:items-end text-center md:text-right">
                        <div class="relative mb-12">
                            <div class="w-72 h-96 rounded-t-full border-[15px] border-[var(--bg-light)] overflow-hidden shadow-2xl">
                                <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&q=80" class="w-full h-full object-cover" alt="Stevin">
                            </div>
                            <div class="absolute -bottom-6 -right-6 w-24 h-24 bg-[var(--primary-dark)] text-[var(--accent)] rounded-full flex items-center justify-center text-4xl font-cursive border-4 border-white shadow-xl">S</div>
                        </div>
                        <h2 class="text-5xl font-serif mb-4">Stevin Alexander Manalu</h2>
                        <p class="text-[var(--accent)] font-bold mb-4 tracking-[0.4em] uppercase text-[10px]">Putra Pertama Dari</p>
                        <p class="text-lg italic opacity-80 leading-relaxed font-serif">Bapak S. Manalu <br>& Ibu I. Silalahi</p>
                    </div>

                    <!-- Bride -->
                    <div class="reveal flex flex-col items-center md:items-start text-center md:text-left">
                        <div class="relative mb-12">
                            <div class="w-72 h-96 rounded-t-full border-[15px] border-[var(--bg-light)] overflow-hidden shadow-2xl">
                                <img src="https://images.unsplash.com/photo-1549570652-97324981a6fd?auto=format&fit=crop&q=80" class="w-full h-full object-cover" alt="Sittri">
                            </div>
                            <div class="absolute -bottom-6 -left-6 w-24 h-24 bg-[var(--primary-dark)] text-[var(--accent)] rounded-full flex items-center justify-center text-4xl font-cursive border-4 border-white shadow-xl">S</div>
                        </div>
                        <h2 class="text-5xl font-serif mb-4">Sittri Lubis</h2>
                        <p class="text-[var(--accent)] font-bold mb-4 tracking-[0.4em] uppercase text-[10px]">Putri Keenam Dari</p>
                        <p class="text-lg italic opacity-80 leading-relaxed font-serif">Bapak R. Lubis <br>& Ibu B. Sibuea</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Cerita Cinta -->
        <section id="story" class="py-32 bg-[var(--primary-dark)] text-white relative">
            <div class="max-w-4xl mx-auto px-6">
                <div class="text-center mb-24 reveal">
                    <p class="text-[var(--accent)] text-[10px] uppercase tracking-[0.5em] mb-4">OUR LOVE STORY</p>
                    <h2 class="text-5xl font-serif italic">Perjalanan Cinta Kami</h2>
                </div>
                <div class="story-line">
                    <div class="flex flex-col items-center text-center reveal mb-24">
                        <div class="timeline-dot"></div>
                        <span class="text-[var(--accent)] font-serif italic text-2xl mb-3">Awal Pertemuan</span>
                        <h4 class="text-[10px] uppercase tracking-[0.2em] mb-6 font-bold opacity-60">Januari 2024</h4>
                        <p class="opacity-70 font-light leading-relaxed max-w-md mx-auto">Sederhana dan tak terduga, perkenalan yang membawa kita pada kenyamanan yang sama di awal tahun yang penuh harapan.</p>
                    </div>
                    <div class="flex flex-col items-center text-center reveal mb-24">
                        <div class="timeline-dot"></div>
                        <span class="text-[var(--accent)] font-serif italic text-2xl mb-3">Masa Tunangan</span>
                        <h4 class="text-[10px] uppercase tracking-[0.2em] mb-6 font-bold opacity-60">Agustus 2025</h4>
                        <p class="opacity-70 font-light leading-relaxed max-w-md mx-auto">Kita mengikat janji untuk saling menjaga dan melengkapi satu sama lain di depan keluarga besar dengan restu yang tulus.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Acara -->
        <section id="event" class="py-32 px-6 bg-[var(--bg-light)]">
            <div class="max-w-6xl mx-auto grid md:grid-cols-2 gap-12">
                <div class="glass-card p-12 reveal border-t-8 border-t-[var(--accent)] text-center">
                    <h3 class="text-3xl font-serif mb-6">Pemberkatan</h3>
                    <div class="space-y-6">
                        <p class="text-lg">Jumat, 12 Juni 2026</p>
                        <p class="text-lg">08.00 WIB - Selesai</p>
                        <p class="text-lg italic font-serif leading-relaxed">Gedung Pertemuan Utama<br>Jakarta Selatan</p>
                        <div class="pt-8">
                            <button onclick="showToast('Menyimpan ke kalender...')" class="btn-luxury inline-block">Save to Calendar</button>
                        </div>
                    </div>
                </div>
                <div class="glass-card p-12 reveal border-t-8 border-t-[var(--accent)] text-center">
                    <h3 class="text-3xl font-serif mb-6">Resepsi</h3>
                    <div class="space-y-6">
                        <p class="text-lg">Sabtu, 13 Juni 2026</p>
                        <p class="text-lg">19.00 - 21.00 WIB</p>
                        <p class="text-lg italic font-serif leading-relaxed">The Glass House, Ritz Carlton<br>Jakarta</p>
                        <div class="pt-8">
                            <a href="https://maps.google.com" target="_blank" class="btn-luxury inline-block">Google Maps</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Galeri Foto -->
        <section id="gallery" class="py-32 px-6 bg-white">
            <div class="max-w-6xl mx-auto">
                <div class="text-center mb-24 reveal">
                    <p class="text-[var(--primary-light)] text-[10px] uppercase tracking-[0.5em] mb-4">MEMORIES</p>
                    <h2 class="text-5xl font-serif italic mb-6">Visual of Love</h2>
                    <div class="w-24 h-[1px] bg-[var(--accent)] mx-auto"></div>
                </div>

                <div class="gallery-grid reveal">
                    <div class="gallery-item large">
                        <img src="https://images.unsplash.com/photo-1511285560929-80b456fea0bc?auto=format&fit=crop&q=80" alt="Gallery 1">
                    </div>
                    <div class="gallery-item tall">
                        <img src="https://images.unsplash.com/photo-1519741497674-611481863552?auto=format&fit=crop&q=80" alt="Gallery 2">
                    </div>
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1522673607200-1648832cee98?auto=format&fit=crop&q=80" alt="Gallery 3">
                    </div>
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1515934751635-c81c6bc9a2d8?auto=format&fit=crop&q=80" alt="Gallery 4">
                    </div>
                    <div class="gallery-item wide">
                        <img src="https://images.unsplash.com/photo-1583939003579-730e3918a45a?auto=format&fit=crop&q=80" alt="Gallery 5">
                    </div>
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1469334031218-e382a71b716b?auto=format&fit=crop&q=80" alt="Gallery 6">
                    </div>
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1519225421980-715cb0215aed?auto=format&fit=crop&q=80" alt="Gallery 7">
                    </div>
                </div>
            </div>
        </section>

        <!-- RSVP -->
        <section id="rsvp" class="py-32 px-6 bg-white">
            <div class="max-w-5xl mx-auto">
                <div class="text-center mb-24 reveal">
                    <h2 class="text-5xl font-serif italic mb-6">Buku Tamu Digital</h2>
                    <p class="opacity-60 italic">Sampaikan pesan doa dan restu Anda.</p>
                </div>
                <div class="grid md:grid-cols-5 gap-16">
                    <div class="md:col-span-2 reveal">
                        <div class="bg-[var(--bg-light)] p-12 rounded-[3rem] border border-[var(--accent)]">
                            <form id="rsvpForm" class="space-y-8">
                                <div class="border-b border-gray-300 pb-2">
                                    <label class="text-[10px] uppercase tracking-widest font-bold opacity-40 block mb-1">NAMA LENGKAP</label>
                                    <input type="text" id="rsvp_name" required class="w-full bg-transparent outline-none py-2 text-lg italic" placeholder="Nama Anda">
                                </div>
                                <div class="border-b border-gray-300 pb-2">
                                    <label class="text-[10px] uppercase tracking-widest font-bold opacity-40 block mb-1">KEHADIRAN</label>
                                    <select id="rsvp_status" class="w-full bg-transparent outline-none py-2 cursor-pointer font-medium">
                                        <option value="Hadir">Akan Hadir</option>
                                        <option value="Berhalangan">Berhalangan</option>
                                    </select>
                                </div>
                                <div class="border-b border-gray-300 pb-2">
                                    <label class="text-[10px] uppercase tracking-widest font-bold opacity-40 block mb-1">UCAPAN & DOA</label>
                                    <textarea id="rsvp_message" required class="w-full bg-transparent outline-none py-2 h-32 resize-none italic" placeholder="Tulis doa restu..."></textarea>
                                </div>
                                <button type="submit" id="submitBtn" class="btn-luxury w-full">Kirim Ucapan</button>
                            </form>
                        </div>
                    </div>
                    <div class="md:col-span-3 reveal">
                        <div id="greetingsContainer" class="h-[600px] overflow-y-auto space-y-6 pr-4">
                            <p class="text-center opacity-40 italic py-20" id="loadingText">Memuat doa-doa...</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Kado -->
        <section class="py-32 bg-[var(--bg-light)] border-t border-[var(--accent)] text-center px-6">
            <h2 class="text-4xl font-serif italic mb-12">Tanda Kasih</h2>
            <div class="max-w-4xl mx-auto grid md:grid-cols-2 gap-12">
                <div class="p-12 glass-card border border-[var(--accent)]">
                    <p class="text-[10px] font-bold opacity-30 mb-6 uppercase">BANK BRI</p>
                    <h4 class="text-3xl font-serif mb-2 tracking-[0.1em]" id="acc_stevin">6282361119915</h4>
                    <p class="text-sm opacity-60 italic mb-8">a.n Stevin Alexander Manalu</p>
                    <button onclick="copyAcc('acc_stevin')" class="text-[10px] uppercase font-bold tracking-widest border border-black px-6 py-2 rounded-full hover:bg-black hover:text-white transition">Salin Nomor</button>
                </div>
                <div class="p-12 glass-card border border-[var(--accent)]">
                    <p class="text-[10px] font-bold opacity-30 mb-6 uppercase">BANK MANDIRI</p>
                    <h4 class="text-3xl font-serif mb-2 tracking-[0.1em]" id="acc_sittri">1234567890</h4>
                    <p class="text-sm opacity-60 italic mb-8">a.n Sittri Lubis</p>
                    <button onclick="copyAcc('acc_sittri')" class="text-[10px] uppercase font-bold tracking-widest border border-black px-6 py-2 rounded-full hover:bg-black hover:text-white transition">Salin Nomor</button>
                </div>
            </div>
        </section>

        <footer class="py-40 bg-[var(--primary-dark)] text-[#F0EDE7] text-center px-6">
            <div class="reveal">
                <h2 class="text-7xl md:text-[9rem] font-cursive mb-16">Stevin & Sittri</h2>
                <p class="text-[10px] opacity-20 italic">Â© 2026 - Crafted for Forever Love</p>
            </div>
        </footer>
    </main>

    <!-- Firebase SDK & Logic -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, serverTimestamp, query } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js";

        // Konfigurasi dari environment
        const firebaseConfig = JSON.parse(__firebase_config);
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'wedding-stevin-sittri';

        let user = null;
        const greetingsCol = collection(db, 'artifacts', appId, 'public', 'data', 'greetings');

        const initAuth = async () => {
            try {
                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                    await signInWithCustomToken(auth, __initial_auth_token);
                } else {
                    await signInAnonymously(auth);
                }
            } catch (err) {
                console.error("Auth error:", err);
            }
        };

        initAuth();

        onAuthStateChanged(auth, (u) => {
            user = u;
            if (user) loadGreetings();
        });

        function loadGreetings() {
            // Mengambil semua data tanpa filter kompleks (Rule 2)
            onSnapshot(greetingsCol, (snapshot) => {
                const container = document.getElementById('greetingsContainer');
                let greetings = [];
                snapshot.forEach(doc => greetings.push({ id: doc.id, ...doc.data() }));
                
                // Sorting di memory (Rule 2)
                greetings.sort((a, b) => (b.createdAt?.seconds || 0) - (a.createdAt?.seconds || 0));

                if (greetings.length === 0) {
                    container.innerHTML = `<p class="text-center opacity-40 italic py-20">Belum ada ucapan. Jadilah yang pertama!</p>`;
                    return;
                }

                container.innerHTML = greetings.map(g => `
                    <div class="p-8 bg-[var(--bg-light)] rounded-[2.5rem] border border-[var(--accent)]/30 animate-fade-in">
                        <div class="flex justify-between items-start mb-4">
                            <h4 class="font-bold text-sm tracking-widest uppercase">${g.name || 'Anonim'}</h4>
                            <span class="text-[8px] text-[var(--accent)] font-bold uppercase tracking-widest px-2 py-1 bg-white rounded-full shadow-sm">${g.status || 'Hadir'}</span>
                        </div>
                        <p class="text-sm italic opacity-80 leading-relaxed font-serif">"${g.message || ''}"</p>
                    </div>
                `).join('');
            }, (error) => {
                console.error("Firestore error:", error);
            });
        }

        const rsvpForm = document.getElementById('rsvpForm');
        rsvpForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            if (!user) return;

            const btn = document.getElementById('submitBtn');
            const name = document.getElementById('rsvp_name').value;
            const status = document.getElementById('rsvp_status').value;
            const message = document.getElementById('rsvp_message').value;

            btn.disabled = true;
            btn.innerText = "MENGIRIM...";

            try {
                await addDoc(greetingsCol, { 
                    name, 
                    status, 
                    message, 
                    createdAt: serverTimestamp(),
                    uid: user.uid
                });
                rsvpForm.reset();
                showToast("Ucapan berhasil terkirim!");
            } catch (err) {
                console.error(err);
                showToast("Gagal mengirim ucapan.");
            } finally {
                btn.disabled = false;
                btn.innerText = "Kirim Ucapan";
            }
        });
    </script>

    <script>
        const audio = document.getElementById('weddingMusic');
        const overlay = document.getElementById('cover-overlay');
        const musicToggle = document.getElementById('musicToggle');
        const nav = document.getElementById('floating-nav');
        const toast = document.getElementById('toast');

        // Countdown Logic
        const targetDate = new Date("June 12, 2026 08:00:00").getTime();
        setInterval(() => {
            const now = new Date().getTime();
            const distance = targetDate - now;
            if (distance < 0) return;
            document.getElementById("days").innerText = Math.floor(distance / (1000 * 60 * 60 * 24)).toString().padStart(2, '0');
            document.getElementById("hours").innerText = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)).toString().padStart(2, '0');
            document.getElementById("minutes").innerText = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60)).toString().padStart(2, '0');
            document.getElementById("seconds").innerText = Math.floor((distance % (1000 * 60)) / 1000).toString().padStart(2, '0');
        }, 1000);

        function openInvitation() {
            document.body.classList.remove('no-scroll');
            overlay.classList.add('fade-out');
            musicToggle.classList.remove('hidden');
            nav.classList.add('show');
            
            // Play Audio
            audio.play().then(() => { 
                musicToggle.classList.add('playing'); 
            }).catch(e => console.log("Autoplay blocked"));

            setTimeout(() => { 
                overlay.style.display = 'none'; 
            }, 1800);
            
            reveal();
        }

        function toggleMusic() {
            if (audio.paused) { 
                audio.play(); 
                musicToggle.classList.add('playing'); 
            } else { 
                audio.pause(); 
                musicToggle.classList.remove('playing'); 
            }
        }

        function reveal() {
            const reveals = document.querySelectorAll(".reveal");
            const windowHeight = window.innerHeight;
            reveals.forEach(el => {
                const elementTop = el.getBoundingClientRect().top;
                if (elementTop < windowHeight - 50) el.classList.add("active");
            });
        }

        window.addEventListener("scroll", reveal);

        function showToast(msg) {
            toast.innerText = msg;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        function copyAcc(id) {
            const text = document.getElementById(id).innerText;
            const tempInput = document.createElement("input");
            tempInput.value = text;
            document.body.appendChild(tempInput);
            tempInput.select();
            document.execCommand("copy");
            document.body.removeChild(tempInput);
            showToast("Nomor rekening berhasil disalin!");
        }

        // Ambil nama tamu dari URL (misal: ?to=Nama+Tamu)
        window.onload = () => {
            const urlParams = new URLSearchParams(window.location.search);
            const guestName = urlParams.get('to');
            if (guestName) {
                document.getElementById('guest-name').innerText = guestName;
            }
        };
    </script>
</body>
</html>